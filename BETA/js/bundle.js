"use strict";function getSuffixMod(e){return jsonSuffixes[e].hasOwnProperty("stats")?jsonSuffixes[e].stats.atk:".0"}function getEquipmentByName(e){var t="";return $.each(jsonEquipments,function(n,r){if(e==r.name)return t=r,!1}),t}function getEquipmentNameById(e){return jsonEquipments[e-1].name}function getEquipmentIdByName(e){var t="";return $.each(jsonEquipments,function(n,r){if(r.name==e)return t=n,!1}),t}function getPrefixIdByName(e){var t="";return $.each(jsonPrefixes,function(n,r){if(r.name==e)return t=n,!1}),t}function getPotionIdByName(e){var t="";return $.each(jsonPotions,function(n,r){if(r.name==e)return t=n,!1}),t}function getBaseStatByType(e){return jsonFormulas[e]}function getMaterialById(e,t){var n=[];return $.each(e,function(e,r){var a=jsonMaterials[r-1],i={name:a.name,amount:t[e],rarity:a.rarity,icon:a.image,what:"material"};n.push(i)}),n}function getMaterialByIdSpec(e,t,n){var r=[];return $.each(e,function(e,a){if(n[e]){var i="",o="";if("consumable"==n[e]){var i=jsonPotions[a-1];o="consumable"}else if("equipment"==n[e]){var i=jsonEquipments[a-1];o=1==jsonEquipments[a-1].itemSlot?"weapon":6==jsonEquipments[a-1].itemSlot?"trinket":"armor"}var s={name:i.name,amount:t[e],rarity:i.rarity,icon:i.image,what:o};r.push(s)}else{var i=jsonMaterials[a-1],s={name:i.name,amount:t[e],rarity:i.rarity,icon:i.image,what:"material"};r.push(s)}}),r}function getMaterialNameById(e){return jsonMaterials[e-1].name}function getMaterialByName(e){var t="";return $.each(jsonMaterials,function(n,r){if(e==r.name)return t=r,!1}),t}function getMaterialIdByName(e){var t="";return $.each(jsonMaterials,function(n,r){if(r.name==e)return t=n,!1}),t}function getMonsterByTrinketId(e){var t=[];$.each(jsonQuests,function(n,r){if(r.hasOwnProperty("trinketA")&&r.trinketA[0]-1==e){var a=(r.trinketA[0]-1,{name:r.name,region:r.region,icon:r.image,rarity:r.title,dropRate:r.trinketA[1]});a.region=regionById(r.region),t.push(a)}if(r.hasOwnProperty("trinketB")&&r.trinketB[0]-1==e){var a=(r.trinketB[0]-1,{name:r.nameB,region:r.region,icon:r.image,rarity:r.titleB,dropRate:r.trinketB[1]});a.region=regionById(r.region),t.push(a)}});var n=[],r=[];return $.each(jsonParcel,function(t,a){var i=0,o="",s="",l="";if($.each(a.itemList,function(n,a){if(i+=a.odds,a.id[1]-1==e){a.amount[5]?(o=a.amount[0],s=a.amount[4]):a.amount[3]?(o=a.amount[0],s=a.amount[2]):(o=a.amount[0],s=a.amount[0]),l=a.odds;var u=r.indexOf(t);u<0&&r.push(t)}}),l){var u=l/(i+1.25*a.nilOdds)*100,m=l/(i+.75*a.nilOdds)*100,d={name:t,min:o,max:s,oddsMin:u,oddsMax:m};n.push(d)}}),$.each(jsonQuests,function(e,a){if("Placeholder"!=a.title){var i=r.indexOf(a.rewardA3);if(i>-1){var o={name:a.name,rarity:a.title,icon:a.image,oddsMin:n[i].oddsMin,oddsMax:n[i].oddsMax,min:n[i].min,max:n[i].max,region:regionById(a.region)};t.push(o)}if(i=r.indexOf(a.rewardA4),i>-1){var o={name:a.name,rarity:a.title,icon:a.image,oddsMin:n[i].oddsMin,oddsMax:n[i].oddsMax,min:n[i].min,max:n[i].max,region:regionById(a.region)};t.push(o)}if(a.hasOwnProperty("nameB")){if(i=r.indexOf(a.rewardB3),i>-1){var o={name:a.nameB,rarity:a.titleB,icon:a.image,oddsMin:n[i].oddsMin,oddsMax:n[i].oddsMax,min:n[i].min,max:n[i].max,region:regionById(a.region)};t.push(o)}if(i=r.indexOf(a.rewardB4),i>-1){var o={name:a.nameB,rarity:a.titleB,icon:a.image,oddsMin:n[i].oddsMin,oddsMax:n[i].oddsMax,min:n[i].min,max:n[i].max,region:regionById(a.region)};t.push(o)}}}}),t}function regionById(e){var t="";return 1==e?t="Tuvale Forest":2==e?t="Yarsol Cove":3==e?t="Aldur Highlands":4==e?t="Vulkrum Badlands":5==e?t="Grimhal Volcano":6==e&&(t="Frentir Chasm"),t}function getHeroByName(e){var t="";return $.each(jsonHeroes,function(n,r){if(r.name==e)return t=r,!1}),t}function getPotionByName(e){var t="";return $.each(jsonPotions,function(n,r){if(r.name==e)return t=r,!1}),t}function getReward(e){if(!jsonParcel[e])return null;var t=[];return t.nilOdds=jsonParcel[e].nilOdds,t.totalOdds=0,t.items=[],$.each(jsonParcel[e].itemList,function(e,n){if(!$.isEmptyObject(n)){var r="",a="",i="",o="",s="",l="",u="",m="";n.id[1]?(a=jsonEquipments[n.id[1]-1].name,i=jsonEquipments[n.id[1]-1].image,o=jsonEquipments[n.id[1]-1].rarity,s="trinket"):(a=jsonMaterials[n.id[0]-1].name,i=jsonMaterials[n.id[0]-1].image,o=jsonMaterials[n.id[0]-1].rarity,s="material"),n.amount.length>1?(l=n.amount[0],u=n.amount[n.amount.length-2]):(l=n.amount[0],u=n.amount[0]),m=n.odds,t.totalOdds+=n.odds,r={name:a,image:i,rarity:o,type:s,min:l,max:u,odd:m},t.items.push(r)}}),t}function usedToCraftFromMaterial(e){var t=[];return $.each(jsonEquipments,function(n,r){$.each(r.materialID,function(n,a){if(a-1==e&&r.hasOwnProperty("materialType")&&"equipment"!=r.materialType[n]||a-1==e&&!r.hasOwnProperty("materialType")){var i="";i=1==r.itemSlot?"weapon":6==r.itemSlot?"trinket":"armor";var o={name:r.name,image:r.image,rarity:r.rarity,type:i,amount:r.materialAmount[n]};return t.push(o),!1}})}),$.each(jsonPotions,function(n,r){$.each(r.materialID,function(n,a){if(a-1==e&&r.hasOwnProperty("materialType")&&"consumable"!=r.materialType[n]||a-1==e&&!r.hasOwnProperty("materialType")){var i={name:r.name,image:r.image,rarity:r.rarity,type:"potion",amount:r.materialAmount[n]};return t.push(i),!1}})}),$.each(jsonMaterials,function(n,r){$.each(r.materialID,function(n,a){if(a-1==e){var i={name:r.name,image:r.image,rarity:r.rarity,type:"material",amount:r.materialAmount[n]};return t.push(i),!1}})}),t}function usedToCraftFromPotion(e){var t=[];return $.each(jsonPotions,function(n,r){$.each(r.materialID,function(n,a){if(r.hasOwnProperty("materialType")&&a-1==e&&"consumable"==r.materialType[n]){var i={name:r.name,image:r.image,rarity:r.rarity,type:"potion",amount:r.materialAmount[n]};return t.push(i),!1}})}),t}function usedToCraftFromEquipment(e){var t=[];return $.each(jsonEquipments,function(n,r){$.each(r.materialID,function(n,a){if(r.hasOwnProperty("materialType")&&a-1==e&&"equipment"==r.materialType[n]){var i={name:r.name,image:r.image,rarity:r.rarity,type:"weapon",amount:r.materialAmount[n]};return t.push(i),!1}})}),t}function getPrefixStatByName(e){var t="";return $.each(jsonPrefixes,function(n,r){if(e==r.name)return t={name:Object.keys(r.stats)[0],val:r.stats[Object.keys(r.stats)[0]]},!1}),t}function trimDate(e){var t=10,n=e.substring(0,t);return n}var mainApp=angular.module("mainApp",["snap","angucomplete-alt","ngRoute","ngSanitize"]).config(["$locationProvider",function(e){e.html5Mode(!1).hashPrefix("!")}]).config(["$compileProvider",function(e){e.debugInfoEnabled(!1)}]).config(["snapRemoteProvider",function(e){e.globalOptions.disable="left",e.globalOptions.touchToDrag=!1}]).config(["$routeProvider",function(e){e.when("/items/weapon/:id",{templateUrl:"pages/eqWeapon.html",controller:"eqWeaponCtrl"}).when("/items/armor/:id",{templateUrl:"pages/eqArmor.html",controller:"eqArmorCtrl"}).when("/items/trinket/:id",{templateUrl:"pages/eqTrinket.html",controller:"eqTrinketCtrl"}).when("/items/material/:id",{templateUrl:"pages/materials.html",controller:"materialCtrl"}).when("/items/consumable/:id",{templateUrl:"pages/potions.html",controller:"potionCtrl"}).when("/items/weapons",{templateUrl:"pages/itemWeapon.html",controller:"itemWeaponCtrl"}).when("/items/armors",{templateUrl:"pages/itemArmor.html",controller:"itemArmorCtrl"}).when("/items/trinkets",{templateUrl:"pages/itemTrinket.html",controller:"itemTrinketCtrl"}).when("/items/consumables",{templateUrl:"pages/itemPotion.html",controller:"itemPotionCtrl"}).when("/items/materials",{templateUrl:"pages/itemMaterial.html",controller:"itemMaterialCtrl"}).when("/heroes/:id",{templateUrl:"pages/heroes.html",controller:"heroCtrl"}).when("/quests/:id",{templateUrl:"pages/quests.html",controller:"questCtrl"}).when("/regios/:id",{templateUrl:"pages/regios.html",controller:"regioCtrl"}).when("/tools",{templateUrl:"pages/tools.html",controller:"toolCtrl"}).when("/tools/compare",{templateUrl:"pages/toolCompare.html",controller:"toolCompareCtrl"}).when("/tools/comparison-help",{templateUrl:"pages/comparison-help.html",controller:"toolCtrl"}).when("/guides",{templateUrl:"pages/guides.html",controller:"guidesCtrl"}).when("/guides/:id",{templateUrl:"pages/guide.html",controller:"guideCtrl"}).when("/",{templateUrl:"main.html",controller:"mainCtrl"}).otherwise({redirectTo:"/"})}]).run(["$rootScope","$route",function(e,t){e.$on("$routeChangeSuccess",function(){var e=window.location.href.split("/");e=e[e.length-1].replace(/%20/g," ").replace(/%27/g,"'"),0==e.length&&(e="Main");var t=e.split("?")[0],n=e.split("?")[1],r="",a="";n&&(n=n.split("&"),$.each(n,function(e,t){t=t.split("="),"prefix"==t[0]?a=jsonPrefixes[t[1]||"0"].name:"suffix"==t[0]&&(r=jsonSuffixes[t[1]||"0"].name)})),document.title=a+" "+t+" "+r+" - MerchantDB",window.scrollTo(0,0),$("#comments").hide(),$("#commentsButton").show()})}]);(function(e,t){var n=n||function(n){var r={element:null,dragger:null,disable:"none",addBodyClasses:!0,hyperextensible:!0,resistance:.5,flickThreshold:50,transitionSpeed:.3,easing:"ease",maxPosition:266,minPosition:-266,tapToClose:!0,touchToDrag:!0,slideIntent:40,minDragDistance:5},a={simpleStates:{opening:null,towards:null,hyperExtending:null,halfway:null,flick:null,translation:{absolute:0,relative:0,sinceDirectionChange:0,percentage:0}}},i={},o={hasTouch:"ontouchstart"in t.documentElement||e.navigator.msPointerEnabled,eventType:function(e){var t={down:o.hasTouch?"touchstart":"mousedown",move:o.hasTouch?"touchmove":"mousemove",up:o.hasTouch?"touchend":"mouseup",out:o.hasTouch?"touchcancel":"mouseout"};return t[e]},page:function(e,t){return o.hasTouch&&t.touches.length&&t.touches[0]?t.touches[0]["page"+e]:t["page"+e]},klass:{has:function(e,t){return e.className.indexOf(t)!==-1},add:function(e,t){!o.klass.has(e,t)&&r.addBodyClasses&&(e.className+=" "+t)},remove:function(e,t){r.addBodyClasses&&(e.className=e.className.replace(t,"").replace(/^\s+|\s+$/g,""))}},dispatchEvent:function(e){if("function"==typeof i[e])return i[e].call()},vendor:function(){var e,n=t.createElement("div"),r="webkit Moz O ms".split(" ");for(e in r)if("undefined"!=typeof n.style[r[e]+"Transition"])return r[e]},transitionCallback:function(){return"Moz"===a.vendor||"ms"===a.vendor?"transitionend":a.vendor+"TransitionEnd"},canTransform:function(){return"undefined"!=typeof r.element.style[a.vendor+"Transform"]},deepExtend:function(e,t){var n;for(n in t)t[n]&&t[n].constructor&&t[n].constructor===Object?(e[n]=e[n]||{},o.deepExtend(e[n],t[n])):e[n]=t[n];return e},angleOfDrag:function(e,t){var n,r;return r=Math.atan2(-(a.startDragY-t),a.startDragX-e),r<0&&(r+=2*Math.PI),n=Math.floor(r*(180/Math.PI)-180),n<0&&n>-180&&(n=360-Math.abs(n)),Math.abs(n)},events:{addEvent:function(e,t,n){return e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):void 0},removeEvent:function(e,t,n){return e.addEventListener?e.removeEventListener(t,n,!1):e.attachEvent?e.detachEvent("on"+t,n):void 0},prevent:function(e){e.preventDefault?e.preventDefault():e.returnValue=!1}},parentUntil:function(e,t){for(var n="string"==typeof t;e.parentNode;){if(n&&e.getAttribute&&e.getAttribute(t))return e;if(!n&&e===t)return e;e=e.parentNode}return null}},s={translate:{get:{matrix:function(t){if(o.canTransform()){var n=e.getComputedStyle(r.element)[a.vendor+"Transform"].match(/\((.*)\)/),i=8;return n?(n=n[1].split(","),16===n.length&&(t+=i),parseInt(n[t],10)):0}return parseInt(r.element.style.left,10)}},easeCallback:function(){r.element.style[a.vendor+"Transition"]="",a.translation=s.translate.get.matrix(4),a.easing=!1,clearInterval(a.animatingInterval),0===a.easingTo&&(o.klass.remove(t.body,"snapjs-right"),o.klass.remove(t.body,"snapjs-left")),o.dispatchEvent("animated"),o.events.removeEvent(r.element,o.transitionCallback(),s.translate.easeCallback)},easeTo:function(e){o.canTransform()?(a.easing=!0,a.easingTo=e,r.element.style[a.vendor+"Transition"]="all "+r.transitionSpeed+"s "+r.easing,a.animatingInterval=setInterval(function(){o.dispatchEvent("animating")},1),o.events.addEvent(r.element,o.transitionCallback(),s.translate.easeCallback),s.translate.x(e)):(a.translation=e,s.translate.x(e)),0===e&&(r.element.style[a.vendor+"Transform"]="")},x:function(n){if(!("left"===r.disable&&n>0||"right"===r.disable&&n<0))if(r.hyperextensible||(n===r.maxPosition||n>r.maxPosition?n=r.maxPosition:(n===r.minPosition||n<r.minPosition)&&(n=r.minPosition)),n=parseInt(n,10),isNaN(n)&&(n=0),o.canTransform()){var i="translate3d("+n+"px, 0,0)";r.element.style[a.vendor+"Transform"]=i}else r.element.style.width=(e.innerWidth||t.documentElement.clientWidth)+"px",r.element.style.left=n+"px",r.element.style.right=""}},drag:{listen:function(){a.translation=0,a.easing=!1,o.events.addEvent(r.element,o.eventType("down"),s.drag.startDrag),o.events.addEvent(r.element,o.eventType("move"),s.drag.dragging),o.events.addEvent(r.element,o.eventType("up"),s.drag.endDrag)},stopListening:function(){o.events.removeEvent(r.element,o.eventType("down"),s.drag.startDrag),o.events.removeEvent(r.element,o.eventType("move"),s.drag.dragging),o.events.removeEvent(r.element,o.eventType("up"),s.drag.endDrag)},startDrag:function(e){var t=e.target?e.target:e.srcElement,n=o.parentUntil(t,"data-snap-ignore");if(n)return void o.dispatchEvent("ignore");if(r.dragger){var i=o.parentUntil(t,r.dragger);if(!i&&a.translation!==r.minPosition&&a.translation!==r.maxPosition)return}o.dispatchEvent("start"),r.element.style[a.vendor+"Transition"]="",a.isDragging=!0,a.hasIntent=null,a.intentChecked=!1,a.startDragX=o.page("X",e),a.startDragY=o.page("Y",e),a.dragWatchers={current:0,last:0,hold:0,state:""},a.simpleStates={opening:null,towards:null,hyperExtending:null,halfway:null,flick:null,translation:{absolute:0,relative:0,sinceDirectionChange:0,percentage:0}}},dragging:function(e){if(a.isDragging&&r.touchToDrag){var n,i=o.page("X",e),l=o.page("Y",e),u=a.translation,m=s.translate.get.matrix(4),d=i-a.startDragX,c=m>0,p=d;if(a.intentChecked&&!a.hasIntent)return;if(r.addBodyClasses&&(m>0?(o.klass.add(t.body,"snapjs-left"),o.klass.remove(t.body,"snapjs-right")):m<0&&(o.klass.add(t.body,"snapjs-right"),o.klass.remove(t.body,"snapjs-left"))),a.hasIntent===!1||null===a.hasIntent){var f=o.angleOfDrag(i,l),g=f>=0&&f<=r.slideIntent||f<=360&&f>360-r.slideIntent,h=f>=180&&f<=180+r.slideIntent||f<=180&&f>=180-r.slideIntent;h||g?a.hasIntent=!0:a.hasIntent=!1,a.intentChecked=!0}if(r.minDragDistance>=Math.abs(i-a.startDragX)||a.hasIntent===!1)return;o.events.prevent(e),o.dispatchEvent("drag"),a.dragWatchers.current=i,a.dragWatchers.last>i?("left"!==a.dragWatchers.state&&(a.dragWatchers.state="left",a.dragWatchers.hold=i),a.dragWatchers.last=i):a.dragWatchers.last<i&&("right"!==a.dragWatchers.state&&(a.dragWatchers.state="right",a.dragWatchers.hold=i),a.dragWatchers.last=i),c?(r.maxPosition<m&&(n=(m-r.maxPosition)*r.resistance,p=d-n),a.simpleStates={opening:"left",towards:a.dragWatchers.state,hyperExtending:r.maxPosition<m,halfway:m>r.maxPosition/2,flick:Math.abs(a.dragWatchers.current-a.dragWatchers.hold)>r.flickThreshold,translation:{absolute:m,relative:d,sinceDirectionChange:a.dragWatchers.current-a.dragWatchers.hold,percentage:m/r.maxPosition*100}}):(r.minPosition>m&&(n=(m-r.minPosition)*r.resistance,p=d-n),a.simpleStates={opening:"right",towards:a.dragWatchers.state,hyperExtending:r.minPosition>m,halfway:m<r.minPosition/2,flick:Math.abs(a.dragWatchers.current-a.dragWatchers.hold)>r.flickThreshold,translation:{absolute:m,relative:d,sinceDirectionChange:a.dragWatchers.current-a.dragWatchers.hold,percentage:m/r.minPosition*100}}),s.translate.x(p+u)}},endDrag:function(e){if(a.isDragging){o.dispatchEvent("end");var t=s.translate.get.matrix(4);if(0===a.dragWatchers.current&&0!==t&&r.tapToClose)return o.dispatchEvent("close"),o.events.prevent(e),s.translate.easeTo(0),a.isDragging=!1,void(a.startDragX=0);"left"===a.simpleStates.opening?a.simpleStates.halfway||a.simpleStates.hyperExtending||a.simpleStates.flick?a.simpleStates.flick&&"left"===a.simpleStates.towards?s.translate.easeTo(0):(a.simpleStates.flick&&"right"===a.simpleStates.towards||a.simpleStates.halfway||a.simpleStates.hyperExtending)&&s.translate.easeTo(r.maxPosition):s.translate.easeTo(0):"right"===a.simpleStates.opening&&(a.simpleStates.halfway||a.simpleStates.hyperExtending||a.simpleStates.flick?a.simpleStates.flick&&"right"===a.simpleStates.towards?s.translate.easeTo(0):(a.simpleStates.flick&&"left"===a.simpleStates.towards||a.simpleStates.halfway||a.simpleStates.hyperExtending)&&s.translate.easeTo(r.minPosition):s.translate.easeTo(0)),a.isDragging=!1,a.startDragX=o.page("X",e)}}}},l=function(e){e.element&&(o.deepExtend(r,e),a.vendor=o.vendor(),s.drag.listen())};this.open=function(e){o.dispatchEvent("open"),o.klass.remove(t.body,"snapjs-expand-left"),o.klass.remove(t.body,"snapjs-expand-right"),"left"===e?(a.simpleStates.opening="left",a.simpleStates.towards="right",o.klass.add(t.body,"snapjs-left"),o.klass.remove(t.body,"snapjs-right"),s.translate.easeTo(r.maxPosition)):"right"===e&&(a.simpleStates.opening="right",a.simpleStates.towards="left",o.klass.remove(t.body,"snapjs-left"),o.klass.add(t.body,"snapjs-right"),s.translate.easeTo(r.minPosition))},this.close=function(){o.dispatchEvent("close"),s.translate.easeTo(0)},this.expand=function(n){var r=e.innerWidth||t.documentElement.clientWidth;"left"===n?(o.dispatchEvent("expandLeft"),o.klass.add(t.body,"snapjs-expand-left"),o.klass.remove(t.body,"snapjs-expand-right")):(o.dispatchEvent("expandRight"),o.klass.add(t.body,"snapjs-expand-right"),o.klass.remove(t.body,"snapjs-expand-left"),r*=-1),s.translate.easeTo(r)},this.on=function(e,t){return i[e]=t,this},this.off=function(e){i[e]&&(i[e]=!1)},this.enable=function(){o.dispatchEvent("enable"),s.drag.listen()},this.disable=function(){o.dispatchEvent("disable"),s.drag.stopListening()},this.settings=function(e){o.deepExtend(r,e)},this.state=function(){var e,t=s.translate.get.matrix(4);return e=t===r.maxPosition?"left":t===r.minPosition?"right":"closed",{state:e,info:a.simpleStates}},l(n)};"undefined"!=typeof module&&module.exports&&(module.exports=n),"undefined"==typeof ender&&(this.Snap=n),"function"==typeof define&&define.amd&&define("snap",[],function(){return n})}).call(this,window,document),function(e,t){"undefined"!=typeof module&&module.exports?module.exports=t(require("angular")):"function"==typeof define&&define.amd?define(["angular"],t):t(e.angular)}(window,function(e){e.module("angucomplete-alt",[]).directive("angucompleteAlt",["$q","$parse","$http","$sce","$timeout","$templateCache","$interpolate",function(e,t,n,r,a,i,o){function s(t,i,o,s){function M(e,n){e&&("object"==typeof e?(t.searchStr=P(e),T({originalObject:e})):"string"==typeof e&&e.length>0?t.searchStr=e:console&&console.error&&console.error("Tried to set "+(n?"initial":"")+" value of angucomplete to",e,"which is an invalid value"),A(!0))}function k(e){pe=null,t.hideResults(e),document.body.removeEventListener("click",k)}function C(e){return e.which?e.which:e.keyCode}function T(e){"function"==typeof t.selectedObject?t.selectedObject(e,t.selectedObjectData):t.selectedObject=e,A(e?!0:!1)}function b(e){return function(n){return t[e]?t[e](n):n}}function B(e){T({originalObject:e}),t.clearSelected&&(t.searchStr=null),Q()}function P(e){return t.titleField.split(",").map(function(t){return $(e,t)}).join(" ")}function $(e,t){var n,r;if(t){n=t.split("."),r=e;for(var a=0;a<n.length;a++)r=r[n[a]]}else r=e;return r}function I(e,n){var a,i,o;if(o=new RegExp(n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"i"),e)return e.match&&e.replace||(e=e.toString()),i=e.match(o),a=i?e.replace(o,'<span class="'+t.matchClass+'">'+i[0]+"</span>"):e,r.trustAsHtml(a)}function A(e){t.notEmpty=e,le=t.searchStr,t.fieldRequired&&s&&t.inputName&&s[t.inputName].$setValidity(se,e)}function j(e){var n=C(e);if(n!==d&&n!==u)if(n===m||n===p)e.preventDefault();else if(n===l)e.preventDefault(),!t.showDropdown&&t.searchStr&&t.searchStr.length>=ie&&(_(),t.searching=!0,X(t.searchStr));else if(n===c)Q(),t.$apply(function(){ae.val(t.searchStr)});else{if(0===ie&&!t.searchStr)return;t.searchStr&&""!==t.searchStr?t.searchStr.length>=ie&&(_(),oe&&a.cancel(oe),t.searching=!0,oe=a(function(){X(t.searchStr)},t.pause)):t.showDropdown=!1,le&&le!==t.searchStr&&!t.clearSelected&&t.$apply(function(){T()})}}function D(e){!t.overrideSuggestions||t.selectedObject&&t.selectedObject.originalObject===t.searchStr||(e&&e.preventDefault(),a.cancel(oe),W(),B(t.searchStr))}function F(e){var t=getComputedStyle(e);return e.offsetHeight+parseInt(t.marginTop,10)+parseInt(t.marginBottom,10)}function O(){return de.getBoundingClientRect().top+parseInt(getComputedStyle(de).maxHeight,10)}function E(){return i[0].querySelectorAll(".angucomplete-row")[t.currentIndex]}function R(){return E().getBoundingClientRect().top-(de.getBoundingClientRect().top+parseInt(getComputedStyle(de).paddingTop,10))}function q(e){de.scrollTop=de.scrollTop+e}function L(){var e=t.results[t.currentIndex];t.matchClass?ae.val(P(e.originalObject)):ae.val(e.title)}function N(e){var n=C(e),r=null,a=null;n===p&&t.results?(t.currentIndex>=0&&t.currentIndex<t.results.length?(e.preventDefault(),t.selectResult(t.results[t.currentIndex])):(D(e),Q()),t.$apply()):n===l&&t.results?(e.preventDefault(),t.currentIndex+1<t.results.length&&t.showDropdown&&(t.$apply(function(){t.currentIndex++,L()}),ce&&(r=E(),O()<r.getBoundingClientRect().bottom&&q(F(r))))):n===m&&t.results?(e.preventDefault(),t.currentIndex>=1?(t.$apply(function(){t.currentIndex--,L()}),ce&&(a=R(),a<0&&q(a-1))):0===t.currentIndex&&t.$apply(function(){t.currentIndex=-1,ae.val(t.searchStr)})):n===f?t.results&&t.results.length>0&&t.showDropdown?t.currentIndex===-1&&t.overrideSuggestions?D():(t.currentIndex===-1&&(t.currentIndex=0),t.selectResult(t.results[t.currentIndex]),t.$digest()):t.searchStr&&t.searchStr.length>0&&D():n===c&&e.preventDefault()}function U(e){return function(n,r,a,i){r||a||i||!n.data||(n=n.data),t.searching=!1,K($(ee(n),t.remoteUrlDataField),e)}}function G(e,n,r,a){t.searching=me,n||r||a||(n=e.status),0!==n&&n!==-1&&(t.remoteUrlErrorCallback?t.remoteUrlErrorCallback(e,n,r,a):console&&console.error&&console.error("http error"))}function W(){ue&&ue.resolve()}function H(r){var a={},i=t.remoteUrl+encodeURIComponent(r);t.remoteUrlRequestFormatter&&(a={params:t.remoteUrlRequestFormatter(r)},i=t.remoteUrl),t.remoteUrlRequestWithCredentials&&(a.withCredentials=!0),W(),ue=e.defer(),a.timeout=ue.promise,me=!0,n.get(i,a).then(U(r))["catch"](G)["finally"](function(){me=!1})}function V(n){W(),ue=e.defer(),t.remoteApiHandler(n,ue.promise).then(U(n))["catch"](G)}function Q(){t.showDropdown=!1,t.results=[],de&&(de.scrollTop=0)}function _(){t.showDropdown=ne,t.currentIndex=t.focusFirst?0:-1,t.results=[]}function z(e){var n,r,a,i,o=t.searchFields.split(","),s=[];for("undefined"!=typeof t.parseInput()&&(e=t.parseInput()(e)),n=0;n<t.localData.length;n++){for(r=!1,a=0;a<o.length;a++)i=$(t.localData[n],o[a])||"",r=r||i.toString().toLowerCase().indexOf(e.toString().toLowerCase())>=0;r&&(s[s.length]=t.localData[n])}return s}function Y(e,n,r){if(!r)return!1;for(var a in n)if(n[a].toLowerCase()===r.toLowerCase())return t.selectResult(e),!0;return!1}function X(e){!e||e.length<ie||(t.localData?t.$apply(function(){var n;n="undefined"!=typeof t.localSearch()?t.localSearch()(e,t.localData):z(e),t.searching=!1,K(n,e)}):t.remoteApiHandler?V(e):H(e))}function K(e,n){var r,a,i,o,s,l;if(e&&e.length>0)for(t.results=[],r=0;r<e.length;r++)t.titleField&&""!==t.titleField&&(o=s=P(e[r])),a="",t.descriptionField&&(a=l=$(e[r],t.descriptionField)),i="",t.imageField&&(i=$(e[r],t.imageField)),t.matchClass&&(s=I(o,n),l=I(a,n)),t.results[t.results.length]={title:s,description:l,image:i,originalObject:e[r]};else t.results=[];t.autoMatch&&1===t.results.length&&Y(t.results[0],{title:o,desc:a||""},t.searchStr)?t.showDropdown=!1:0!==t.results.length||re?t.showDropdown=!0:t.showDropdown=!1}function J(){t.localData?(t.searching=!1,K(t.localData,"")):t.remoteApiHandler?(t.searching=!0,V("")):(t.searching=!0,H(""))}var Z,ee,te,ne,re,ae=i.find("input"),ie=g,oe=null,se=S,le=null,ue=null,me=!1,de=i[0].querySelector(".angucomplete-dropdown"),ce=!1,pe=null;i.on("mousedown",function(e){e.target.id?(pe=e.target.id,pe===t.id+"_dropdown"&&document.body.addEventListener("click",k)):pe=e.target.className}),t.currentIndex=t.focusFirst?0:null,t.searching=!1,te=t.$watch("initialValue",function(e){e&&(te(),M(e,!0))}),t.$watch("fieldRequired",function(e,n){e!==n&&(e?A(le&&t.currentIndex!==-1?!0:!1):s[t.inputName].$setValidity(se,!0))}),t.$on("angucomplete-alt:clearInput",function(e,n){n&&n!==t.id||(t.searchStr=null,T(),A(!1),Q())}),t.$on("angucomplete-alt:changeInput",function(e,n,r){n&&n===t.id&&M(r)}),t.onFocusHandler=function(){t.focusIn&&t.focusIn(),0!==ie||t.searchStr&&0!==t.searchStr.length||(t.currentIndex=t.focusFirst?0:t.currentIndex,t.showDropdown=!0,J())},t.hideResults=function(){pe&&(pe===t.id+"_dropdown"||pe.indexOf("angucomplete")>=0)?pe=null:(Z=a(function(){Q(),t.$apply(function(){t.searchStr&&t.searchStr.length>0&&ae.val(t.searchStr)})},y),W(),t.focusOut&&t.focusOut(),t.overrideSuggestions&&t.searchStr&&t.searchStr.length>0&&t.currentIndex===-1&&D())},t.resetHideResults=function(){Z&&a.cancel(Z)},t.hoverRow=function(e){t.currentIndex=e},t.selectResult=function(e){t.matchClass&&(e.title=P(e.originalObject),e.description=$(e.originalObject,t.descriptionField)),t.clearSelected?t.searchStr=null:t.searchStr=e.title,T(e),Q()},t.inputChangeHandler=function(e){return e.length<ie?(W(),Q()):0===e.length&&0===ie&&J(),t.inputChanged&&(e=t.inputChanged(e)),e},t.fieldRequiredClass&&""!==t.fieldRequiredClass&&(se=t.fieldRequiredClass),t.minlength&&""!==t.minlength&&(ie=parseInt(t.minlength,10)),t.pause||(t.pause=v),t.clearSelected||(t.clearSelected=!1),t.overrideSuggestions||(t.overrideSuggestions=!1),t.fieldRequired&&s&&A(t.initialValue?!0:!1),t.inputType=o.type?o.type:"text",t.textSearching=o.textSearching?o.textSearching:x,t.textNoResults=o.textNoResults?o.textNoResults:w,ne="false"!==t.textSearching,re="false"!==t.textNoResults,t.maxlength=o.maxlength?o.maxlength:h,ae.on("keydown",N),ae.on("keyup compositionend",j),ee=b("remoteUrlResponseFormatter"),a(function(){var e=getComputedStyle(de);ce=e.maxHeight&&"auto"===e.overflowY})}var l=40,u=39,m=38,d=37,c=27,p=13,f=9,g=3,h=524288,v=500,y=200,S="autocomplete-required",x="Searching...",w="No results found",M="/angucomplete-alt/index.html";return i.put(M,'<div class="angucomplete-holder" ng-class="{\'angucomplete-dropdown-visible\': showDropdown}">  <input id="{{id}}_value" name="{{inputName}}" tabindex="{{fieldTabindex}}" ng-class="{\'angucomplete-input-not-empty\': notEmpty}" ng-model="searchStr" ng-disabled="disableInput" type="{{inputType}}" placeholder="{{placeholder}}" maxlength="{{maxlength}}" ng-focus="onFocusHandler()" class="{{inputClass}}" ng-focus="resetHideResults()" ng-blur="hideResults($event)" autocapitalize="off" autocorrect="off" autocomplete="off" ng-change="inputChangeHandler(searchStr)"/>  <div id="{{id}}_dropdown" class="angucomplete-dropdown" ng-show="showDropdown">    <div class="angucomplete-searching" ng-show="searching" ng-bind="textSearching"></div>    <div class="angucomplete-searching" ng-show="!searching && (!results || results.length == 0)" ng-bind="textNoResults"></div>    <div class="angucomplete-row" ng-repeat="result in results" ng-click="selectResult(result)" ng-mouseenter="hoverRow($index)" ng-class="{\'angucomplete-selected-row\': $index == currentIndex}">      <div ng-if="imageField" class="angucomplete-image-holder">        <img ng-if="result.image && result.image != \'\'" ng-src="{{result.image}}" class="angucomplete-image"/>        <div ng-if="!result.image && result.image != \'\'" class="angucomplete-image-default"></div>      </div>      <div class="angucomplete-title" ng-if="matchClass" ng-bind-html="result.title"></div>      <div class="angucomplete-title" ng-if="!matchClass">{{ result.title }}</div>      <div ng-if="matchClass && result.description && result.description != \'\'" class="angucomplete-description" ng-bind-html="result.description"></div>      <div ng-if="!matchClass && result.description && result.description != \'\'" class="angucomplete-description">{{result.description}}</div>    </div>  </div></div>'),{restrict:"EA",require:"^?form",scope:{selectedObject:"=",selectedObjectData:"=",disableInput:"=",initialValue:"=",localData:"=",localSearch:"&",remoteUrlRequestFormatter:"=",remoteUrlRequestWithCredentials:"@",remoteUrlResponseFormatter:"=",remoteUrlErrorCallback:"=",remoteApiHandler:"=",id:"@",type:"@",placeholder:"@",textSearching:"@",textNoResults:"@",remoteUrl:"@",remoteUrlDataField:"@",titleField:"@",descriptionField:"@",imageField:"@",inputClass:"@",pause:"@",searchFields:"@",minlength:"@",matchClass:"@",clearSelected:"@",overrideSuggestions:"@",fieldRequired:"=",fieldRequiredClass:"@",inputChanged:"=",autoMatch:"@",focusOut:"&",focusIn:"&",fieldTabindex:"@",inputName:"@",focusFirst:"@",parseInput:"&"},templateUrl:function(e,t){return t.templateUrl||M},compile:function(e){var t=o.startSymbol(),n=o.endSymbol();if("{{"!==t||"}}"!==n){var r=e.html().replace(/\{\{/g,t).replace(/\}\}/g,n);e.html(r)}return s}}}])}),angular.module("snap",[]),function(){var e=[1,8,5],t={full:e.join("."),major:e[0],minor:e[1],patch:e[2]};angular.module("snap").constant("SNAP_VERSION",t)}(),angular.module("snap").directive("snapClose",["$rootScope","snapRemote",function(e,t){return{restrict:"A",link:function(n,r,a){r.bind("click",function(){t.close(n.$eval(a.snapId)),e.$digest()})}}}]),angular.module("snap").directive("snapContent",["SnapConstructor","snapRemote",function(e,t){return{restrict:"AE",link:function(n,r,a){r.addClass("snap-content");var i=a.snapId;i&&(i=n.$eval(a.snapId));var o=angular.extend({},t.globalOptions),s=function(e,r){n.$watch(function(){return n.$eval(e)},function(e,n){angular.isDefined(n)&&e!==n&&t.getSnapper(i).then(function(t){var n={};n[r]=e,t.settings(n)})})};angular.forEach(a,function(e,t){0===t.indexOf("snapOpt")&&(t=t.substring(7),t.length&&(t=t[0].toLowerCase()+t.substring(1),o[t]=n.$eval(e),s(e,t)))}),o.element=r[0],angular.isDefined(a.snapOptions)&&a.snapOptions&&angular.extend(o,n.$eval(a.snapOptions)),t.register(new e(o),i),angular.isDefined(a.snapOptions)&&a.snapOptions&&n.$watch(a.snapOptions,function(e){t.getSnapper(i).then(function(t){t.settings(e)})},!0),n.$on("$destroy",function(){t.unregister(i)})}}}]),angular.module("snap").directive("snapDragger",["snapRemote",function(e){return{restrict:"AE",link:function(t,n,r){var a=t.$eval(r.snapId);e.getSnapper(a).then(function(e){e.settings({dragger:n[0]})})}}}]),angular.module("snap").directive("snapDrawer",function(){return{restrict:"AE",link:function(e,t,n){t.addClass("snap-drawer");var r=t.parent(),a=!0;for("right"===n.snapDrawer?t.addClass("snap-drawer-right"):t.addClass("snap-drawer-left");r.length;)r.hasClass("snap-drawers")&&(a=!1),r=r.parent();a&&t.wrap('<div class="snap-drawers" />')}}}),angular.module("snap").directive("snapDrawers",function(){return{restrict:"AE",compile:function(e,t){e.addClass("snap-drawers")}}}),angular.module("snap").directive("snapToggle",["$rootScope","snapRemote",function(e,t){return{restrict:"A",link:function(n,r,a){var i=a.snapId,o=a.snapToggle||"left";if(i&&(i=n.$eval(i)),!a.snapUnsafe){var s=!1;r.bind("mousedown",function(e){s=!0,e.stopImmediatePropagation()}),r.bind("mouseup",function(e){s&&e.stopImmediatePropagation(),s=!1})}r.bind("click",function(){t.toggle(o,i),e.$digest()})}}}]),angular.module("snap").provider("SnapConstructor",function(){var e;this.use=function(t){e=t},this.$get=["$window",function(t){var n=e||t.Snap;if(angular.isUndefined(n))throw new Error("Snap constructor is not defined. Make sure window.Snap is defined or supply your own with SnapConstructorProvider.use(MySnap).");return n}]}),angular.module("snap").provider("snapRemote",function(){var e=this;return this.globalOptions={},this.$get=["$q",function(t){var n,r,a={},i="__DEFAULT_SNAPPER_ID__",o={};return o.globalOptions=e.globalOptions,
o.getSnapper=function(e){return e=e||i,a.hasOwnProperty(e)||n(e),a[e].deferred.promise},o.register=function(e,t){t=t||i,a.hasOwnProperty(t)||n(t),a[t].isResolved&&n(t),r(e,t)},o.unregister=function(e){e=e||i,a.hasOwnProperty(e)&&delete a[e]},o.toggle=function(e,t){t=t||i,o.getSnapper(t).then(function(n){e===n.state().state?o.close(t):o.open(e,t)})},o.open=function(e,t){t=t||i,o.getSnapper(t).then(function(t){t.open(e)})},o.close=function(e){e=e||i,o.getSnapper(e).then(function(e){e.close()})},o.expand=function(e,t){t=t||i,o.getSnapper(t).then(function(t){t.expand(e)})},o.enable=function(e){e=e||i,o.getSnapper(e).then(function(e){e.enable()})},o.disable=function(e){e=e||i,o.getSnapper(e).then(function(e){e.disable()})},n=function(e){a[e]={deferred:t.defer(),isResolved:!1}},r=function(e,t){a[t].deferred.resolve(e),a[t].isResolved=!0},o}],this}),$(document).ready(function(){var e="",t="",n="",r="";e=["<ul id='sub-menu-heroes'>","<li><a href='#!/heroes/Warrior'>Warrior</a></li>","<li><a href='#!/heroes/Rogue'>Rogue</a></li>","<li><a href='#!/heroes/Mage'>Mage</a></li>","<li><a href='#!/heroes/Berserker'>Berserker</a></li>","<li><a href='#!/heroes/Cleric'>Cleric</a></li>","<li><a href='#!/heroes/Assassin'>Assassin</a></li>","<li><a href='#!/heroes/Paladin'>Paladin</a></li>","<li><a href='#!/heroes/Dark Knight'>Dark Knight</a></li>","<li><a href='#!/heroes/Bard'>Bard</a></li>","</ul>"].join(""),t=["<ul id='sub-menu-heroes'>","<li><a href='#!/items/weapons'>Weapons</a></li>","<li><a href='#!/items/armors'>Armors</a></li>","<li><a href='#!/items/trinkets'>Trinkets</a></li>","<li><a href='#!/items/consumables'>Consumables</a></li>","<li><a href='#!/items/materials'>Materials</a></li>","</ul>"].join(""),n=["<ul id='sub-menu-zones'>","<li><a href='#!/regios/Tuvale Forest'>Tuvale Forest</a></li>","<li><a href='#!/regios/Yarsol Cove'>Yarsol Cove</a></li>","<li><a href='#!/regios/Aldur Highlands'>Aldur Highlands</a></li>","<li><a href='#!/regios/Vulkrum Badlands'>Vulkrum Badlands</a></li>","<li><a href='#!/regios/Grimhal Volcano'>Grimhal Volcano</a></li>","<li><a href='#!/regios/Frentir Chasm'>Frentir Chasm</a></li>","</ul>"].join(""),r=["<ul id='sub-menu-community'>","<li><a href='https://www.reddit.com/r/MerchantRPG/'>Reddit</a></li>","</ul>"].join(""),$("#hero-link").on("mouseenter",function(){$("#sub-menu-hold").slideDown("fast").empty().append(e),$("#navi-hold>ul>li>a.menu-hovered").removeClass("menu-hovered"),$(this).addClass("menu-hovered")}),$("#item-link").on("mouseenter",function(){$("#sub-menu-hold").slideDown("fast").empty().append(t),$("#navi-hold>ul>li>a.menu-hovered").removeClass("menu-hovered"),$(this).addClass("menu-hovered")}),$("#region-link").on("mouseenter",function(){$("#sub-menu-hold").slideDown("fast").empty().append(n),$("#navi-hold>ul>li>a.menu-hovered").removeClass("menu-hovered"),$(this).addClass("menu-hovered")}),$("#tool-link").on("mouseenter",function(){$("#sub-menu-hold").slideUp("fast").empty(),$("#navi-hold>ul>li>a.menu-hovered").removeClass("menu-hovered"),$(this).addClass("menu-hovered")}),$("#guide-link").on("mouseenter",function(){$("#sub-menu-hold").slideUp("fast").empty(),$("#navi-hold>ul>li>a.menu-hovered").removeClass("menu-hovered"),$(this).addClass("menu-hovered")}),$("#community-link").on("mouseenter",function(){$("#sub-menu-hold").slideUp("fast").empty(),$("#navi-hold>ul>li>a.menu-hovered").removeClass("menu-hovered"),$(this).addClass("menu-hovered")}),$(".nav-menu-desktop").mouseleave(function(){})}),angular.module("mainApp").directive("itemGrade",function(){return{templateUrl:"templates/item-grade-template.html"}}),angular.module("mainApp").directive("itemPageCompareButton",["popupService",function(e){return{link:function(t,n,r){t.show=function(){e.addItemToComparison(t.item,t.suffix,t.prefix,t.grade)}},templateUrl:"templates/item-page-compare-button-template.html"}}]),angular.module("mainApp").directive("itemPageCopyButton",["popupService",function(e){return{link:function(t,n,r){t.show=e.toogleCopyLink},scope:{},templateUrl:"templates/item-page-copy-button-template.html"}}]),angular.module("mainApp").directive("itemPrefix",function(){return{templateUrl:"templates/item-prefix-template.html"}}),angular.module("mainApp").directive("itemPrestige",function(){return{templateUrl:"templates/item-prestige-template.html"}}),angular.module("mainApp").directive("itemSuffix",function(){return{templateUrl:"templates/item-suffix-template.html"}}),angular.module("mainApp").directive("itemUrls",function(){return{templateUrl:"templates/item-urls-template.html"}}),angular.module("mainApp").controller("bodyCtrl",["$scope","guidesService",function(e,t){e.betaVersion="3.015",e.liveVersion="3.02",t.getGuides().then(function(t){e.guidesList=t}),e.getAuthByID=t.getAuthorByID}]),angular.module("mainApp").controller("eqArmorCtrl",["$scope","$routeParams","itemsService",function(e,t,n){e.Math=Math,e.itemID=getEquipmentIdByName(t.id),e.item=jsonEquipments[e.itemID],e.itemBaseStat=getBaseStatByType(e.item.subType),e.rarityMod=jsonRarity,0!=e.item.crafterID&&(e.item.hasOwnProperty("materialType")?e.material=getMaterialByIdSpec(e.item.materialID,e.item.materialAmount,e.item.materialType):e.material=getMaterialById(e.item.materialID,e.item.materialAmount)),e.craft=usedToCraftFromEquipment(e.itemID),n.initFromRoute(e,t),e.itemDef=n.getBaseStat(e,"def"),e.itemMdef=n.getBaseStat(e,"mdef"),e.bonusStats=n.prepareBonusStats(e),e.suffixPrefixChange=function(){var r=n.constructUrl(e,"#!/items/armor/"+t.id);$(location).attr("href",r)}}]),angular.module("mainApp").controller("eqTrinketCtrl",["$scope","$routeParams","itemsService",function(e,t,n){e.Math=Math,e.item=getEquipmentByName(t.id),e.itemID=getEquipmentIdByName(t.id),e.droppedBy=getMonsterByTrinketId(e.itemID),e.rarityMod=jsonRarity,0!=e.item.crafterID&&(e.item.hasOwnProperty("materialType")?e.material=getMaterialByIdSpec(e.item.materialID,e.item.materialAmount,e.item.materialType):e.material=getMaterialById(e.item.materialID,e.item.materialAmount)),e.craft=usedToCraftFromEquipment(e.itemID),n.initFromRoute(e,t),e.bonusStats=n.prepareBonusStats(e),e.suffixPrefixChange=function(){var r=n.constructUrl(e,"#!/items/trinket/"+t.id);$(location).attr("href",r)}}]),angular.module("mainApp").controller("eqWeaponCtrl",["$scope","$routeParams","itemsService",function(e,t,n){e.Math=Math,e.itemID=getEquipmentIdByName(t.id),e.item=jsonEquipments[e.itemID],e.itemBaseStat=getBaseStatByType(e.item.subType),e.rarityMod=jsonRarity,0!=e.item.crafterID&&(e.item.hasOwnProperty("materialType")?e.material=getMaterialByIdSpec(e.item.materialID,e.item.materialAmount,e.item.materialType):e.material=getMaterialById(e.item.materialID,e.item.materialAmount)),e.craft=usedToCraftFromEquipment(e.itemID),n.initFromRoute(e,t),e.itemAtk=n.getBaseStat(e,"atk"),e.itemMatk=n.getBaseStat(e,"matk"),e.itemAcc=n.getBaseStat(e,"acc"),e.bonusStats=n.prepareBonusStats(e),e.suffixPrefixChange=function(){var r=n.constructUrl(e,"#!/items/weapon/"+t.id);$(location).attr("href",r)}}]),angular.module("mainApp").controller("guideCtrl",["$scope","$routeParams","guidesService",function(e,t,n){e.trimDate=trimDate,e.isLoaded=!1,n.getGuides().then(function(r){e.guidesList=r,e.selectedGuide=n.getGuideByTitle(t.id),e.guideAuthor=n.getAuthorByID(e.selectedGuide.author),e.guideTitle=e.selectedGuide.title.rendered,e.guideContent=e.selectedGuide.content.rendered,e.guideDate=e.selectedGuide.date,e.isLoaded=!0})}]),angular.module("mainApp").controller("guidesCtrl",["$scope","$routeParams","guidesService",function(e,t,n){e.isLoaded=!1,n.getGuides().then(function(t){e.guidesList=t,e.isLoaded=!0}),e.getAuthByID=n.getAuthorByID,e.trimDate=trimDate}]),angular.module("mainApp").controller("heroCtrl",["$scope","$routeParams",function(e,t){e.hero=getHeroByName(t.id),e.jsonAbility=jsonAbility,e.heroUnlock="pages/hero-unlock-"+e.hero.name+".html",e.heroRole="pages/hero-role-"+e.hero.name+".html",e.fixMaxLevel=function(){e.maxLevel="2"==e.anc?60:50},e.fixMaxLevel()}]),angular.module("mainApp").controller("itemArmorCtrl",["$scope","$routeParams","filtersService",function(e,t,n){function r(e){return 2==e.itemSlot||3==e.itemSlot||4==e.itemSlot||5==e.itemSlot}function a(t){return n.isMatch(t.subType,e.ArmorsmithFilter)||n.isMatch(t.subType,e.ClothWorkerFilter)}function i(t){return n.isMatch(t.dbTier,e.TiersFilter)}function o(t){return e.ignoreStatsFilter||n.filterStats(t.bonusStat,e.StatsFilter)}e.equipment=jsonEquipments,e.formula=jsonFormulas,e.TiersFilter=n.getTiers(),e.ArmorsmithFilter=n.getArmorsmithTypes(),e.ClothWorkerFilter=n.getClothWorkerTypes(),e.StatsFilter=n.getStatsFilter(),e.ignoreStatsFilter=!0,e.setStatsFilter=function(t,n){e.ignoreStatsFilter=0==t||n},e.finalFilter=function(e){return r(e)&&a(e)&&i(e)&&o(e)}}]),angular.module("mainApp").controller("itemMaterialCtrl",["$scope","$routeParams","filtersService",function(e,t,n){e.TiersFilter=n.getTiers(),e.SubtypesFilter=n.getMaterialTypes(),e.material=jsonMaterials,e.showMaterialsByType=function(t){return n.isMatch(t.subType,e.SubtypesFilter)},e.showMaterialsByTier=function(t){var r=t.dbTier;return n.isMatch(r,e.TiersFilter)}}]),angular.module("mainApp").controller("itemPotionCtrl",["$scope","$routeParams","filtersService",function(e,t,n){e.TiersFilter=n.getTiers(),e.PotionsTypesFilter=n.getPotionsTypes(),e.potion=jsonPotions,e.showPotionsByTier=function(t){return n.isMatch(t.dbTier,e.TiersFilter)},e.showPotionsByType=function(t){return n.isMatch(t.subType,e.PotionsTypesFilter)}}]),angular.module("mainApp").controller("itemTrinketCtrl",["$scope","$routeParams","filtersService",function(e,t,n){function r(t){return n.isMatch(t.dbTier,e.TiersFilter)}function a(t){return n.isMatch(t.subType,e.TypesFilter)}function i(t){return e.ignoreStatsFilter||n.filterStats(t.bonusStat,e.StatsFilter)}e.equipment=jsonEquipments,e.TiersFilter=n.getTiers(),e.TypesFilter=n.getTrinketsTypes(),e.StatsFilter=n.getStatsFilter(),e.ignoreStatsFilter=!0,e.finalFilter=function(e){return 6==e.itemSlot&&r(e)&&a(e)&&i(e)},e.setStatsFilter=function(t,n){e.ignoreStatsFilter=0==t||n}}]),angular.module("mainApp").controller("itemWeaponCtrl",["$scope","$routeParams","filtersService",function(e,t,n){function r(t){return n.isMatch(t.subType,e.BlacksmithFilter)||n.isMatch(t.subType,e.WoodworkerFilter)||n.isMatch(t.subType,e.SpecialFilter)}function a(t){return n.isMatch(t.dbTier,e.TiersFilter)}function i(t){return e.ignoreStatsFilter||n.filterStats(t.bonusStat,e.StatsFilter)}e.equipment=jsonEquipments,e.formula=jsonFormulas,e.TiersFilter=n.getTiers(),e.BlacksmithFilter=n.getBlacksmithTypes(),e.WoodworkerFilter=n.getWoodworkerTypes(),e.SpecialFilter=n.getSpecialTypes(),e.StatsFilter=n.getStatsFilter(),e.ignoreStatsFilter=!0,e.finalFilter=function(e){return 1==e.itemSlot&&r(e)&&a(e)&&i(e)},e.setStatsFilter=function(t,n){e.ignoreStatsFilter=0==t||n}}]),angular.module("mainApp").controller("mainCtrl",["$scope","$routeParams",function(e,t){e.name="Main",e.params=t,e.bosses=jsonBosses,e.quests=jsonQuests;for(var n=Math.floor(Date.now()/1e3),r=0;r<jsonBosses.length;r++){var a=jsonBosses[r];if(a.isBoost=a.resultParams.length>1,a.startTimestamp=a.detectParams[0],a.duration=a.detectParams[1],a.endTimestamp=a.startTimestamp+a.duration,void 0!==a.detectParams[2]){var i=Math.floor((n-a.startTimestamp)/a.detectParams[2])*a.detectParams[2];a.endTimestamp+i<n&&(i+=a.detectParams[2]),a.startTimestamp=a.startTimestamp+i,a.endTimestamp=a.endTimestamp+i}}jsonBosses.sort(function(e,t){return e.startTimestamp-t.startTimestamp})}]),angular.module("mainApp").controller("materialCtrl",["$scope","$routeParams","questService",function(e,t,n){e.Math=Math,e.materialID=getMaterialIdByName(t.id),e.material=jsonMaterials[e.materialID],e.listOfGrades=jsonGrades,e.luck=Math.max(n.luck,0),e.grade=n.grade,e.material.hasOwnProperty("materialID")&&(e.craftedBy=getMaterialById(e.material.materialID,e.material.materialAmount),e.craftTimeMin=jsonGrades[0].craftTimeMin,e.craftTimeMax=jsonGrades[0].craftTimeMax),e.droppedBy=n.getMonsterByMaterialId(e.materialID),e.craft=usedToCraftFromMaterial(e.materialID),e.gradeLuckChange=function(){e.luck>100&&(e.luck=100),n.setValues(e.grade,e.luck),e.droppedBy=n.getMonsterByMaterialId(e.materialID)}}]),angular.module("mainApp").controller("mobileMenuController",["$scope",function(e){$("#mobile-menu li").click(function(e){e.stopPropagation(),$(this).children("ul").slideToggle("slow")})}]),angular.module("mainApp").controller("popupController",["popupService","$timeout",function(e,t){var n=this;n.model=e.popupModel,n.modes=e.modes,n.comparison=e.comparisonModel,n.hide=function(){e.hide()},n.copy=function(r){e.copyModel.showReddit=r;var a=r?"#generatedLink-reddit":"#generatedLink";t(function(){var e=document.querySelector(a);e.select();try{var t=document.execCommand("copy"),r=t?"successful":"unsuccessful";console.log("Copying text command was "+r)}catch(i){console.log("Oops, unable to copy")}n.hide()},10)},n.removeItem1=function(){e.removeItemFromComparison(1)},n.removeItem2=function(){e.removeItemFromComparison(2)},n.goToComparison=function(){var t=n.comparison.item1,r=n.comparison.item2;n.hide();var a="#!/tools/compare?c="+t.id+","+t.prefix+","+t.suffix+",0-"+r.id+","+r.prefix+","+r.suffix+",0";location.href=a,e.clearComparison()}}]),angular.module("mainApp").controller("potionCtrl",["$scope","$routeParams",function(e,t){e.potion=getPotionByName(t.id),e.potionID=getPotionIdByName(t.id),e.potion.hasOwnProperty("materialType")?e.craftedBy=getMaterialByIdSpec(e.potion.materialID,e.potion.materialAmount,e.potion.materialType):e.craftedBy=getMaterialById(e.potion.materialID,e.potion.materialAmount),e.craft=usedToCraftFromPotion(e.potionID),0==e.craft.length&&(e.craft=""),e.craftTimeMin=jsonGrades[0].craftTimeMin,e.craftTimeMax=jsonGrades[0].craftTimeMax,e.crafterName=5==e.potion.crafterID?"Alchemist":"Scribe"}]),angular.module("mainApp").controller("questCtrl",["$scope","$routeParams","questService","regionService",function(e,t,n,r){e.Math=Math,e.quest=r.getQuestByName(t.id,t.gid),e.mats=jsonMaterials,e.eq=jsonEquipments,e.jsonAbility=jsonAbility,e.rarityMod=jsonRarity,e.quest.reward3&&(e.reward3=getReward(e.quest.reward3)),e.quest.reward4&&(e.reward4=getReward(e.quest.reward4)),e.listOfGrades=jsonGrades,n.setupQuestScope(e),e.gradeLuckChange=function(){n.setValues(e.grade,e.luck),n.setupQuestScope(e)}}]),angular.module("mainApp").controller("regioCtrl",["$scope","$routeParams","regionService",function(e,t,n){e.regioName=t.id,e.mats=jsonMaterials,e.eq=jsonEquipments,e.quests=n.getQuestsForRegion(t.id)}]),angular.module("mainApp").controller("searchController",["$scope","searchService",function(e,t){e.gameObjects=jsonSearch,e.itemSelected=function(e){if(e){console.log("selected",e);var t="",n="";"Weapon"==e.originalObject.type?t="items/weapon/":"Armor"==e.originalObject.type?t="items/armor/":"Trinket"==e.originalObject.type?t="items/trinket/":"Material"==e.originalObject.type?t="items/material/":"Potion"==e.originalObject.type?t="items/consumable/":(t="quests/",n="?gid="+e.originalObject.gid);var r="#!/"+t+e.title+n;return $(location).attr("href",r),!1}console.log("cleared")},e.limitedSearch=function(e,n){var r=t.fuseSearch(e).slice(0,20);return r}}]),angular.module("mainApp").controller("toolCompareCtrl",["$scope","$routeParams","itemsService",function(e,t,n){function r(e,t,r,i){for(var s={},l=jsonFormulas[e.subType],u=0;u<a.length;u++){var m=a[u];if("Total Attack"!=m){var d=null,c=null,p=e.bonusStat[m];p&&(d=n.getStatAfterGrade(p[0],i.min),c=n.getStatAfterGrade(p[1],i.max)),t.stat&&t.stat[m]&&(d=(d||0)+t.stat[m],c=(c||0)+t.stat[m]);var f=o[m];if(f&&l){var g=l[f+"Base"];if(g){var h=l[f+"Lvl"],v=1+r.modif;d=(d||0)+Math.ceil(Math.ceil((g+h*e.itemLevel)*i.min)*v),c=(c||0)+Math.ceil(Math.ceil((g+h*e.itemLevel)*i.max)*v)}}d&&(s[m]={min:d,max:c})}else s[m]={min:s.atkBns.min+s.matkBns.min,max:s.atkBns.max+s.matkBns.max}}return s}e.Math=Math,e.equipment=jsonEquipments,e.formula=jsonFormulas,e.suffix=jsonSuffixes,e.prefix=jsonPrefixes,e.grade=jsonGrades,e.rarityMod=jsonRarity,e.getItems=t.c;var a,i=t.c.split("-")[0].split(",")[0],o={atkBns:"atk",matkBns:"matk",accBns:"acc",defBns:"def",mdefBns:"mdef"};1==e.equipment[i].itemSlot?(e.itsWeapon=!0,a=["atkBns","matkBns","Total Attack","accBns","str","dex","int","defBns","mdefBns"]):6==e.equipment[i].itemSlot?(e.itsTrinket=!0,a=["str","dex","int","atkBns","matkBns","accBns","defBns","mdefBns"]):(e.itsArmor=!0,a=["defBns","mdefBns","atkBns","matkBns","accBns","str","dex","int"]),a=a.concat(["hpBns","critBns","lckMod","speed","expMod","atkPct","matkPct","defPct","mdefPct","accPct","hpPct","apMod","critMod"]);var s=t.c.split("-")[0],l=s.split(",")[0];e.item1Stat=e.equipment[l];var u={};u.id=s.split(",")[1],u.name=e.prefix[u.id].name,u.stat=e.prefix[u.id].stats,e.item1Prefix=u;var m={};m.id=s.split(",")[2]||"0",m.name=e.suffix[m.id].name,e.suffix[m.id].hasOwnProperty("stats")?m.modif=e.suffix[m.id].stats.acc:m.modif=0,e.item1Suffix=m;var d={};d.id=s.split(",")[3],d.name=e.grade[d.id].name,d.min=e.grade[d.id].min,d.max=e.grade[d.id].max,e.item1Grade=d;var c=t.c.split("-")[1],p=c.split(",")[0];p=e.equipment[p],e.item2Stat=p;var f={};f.id=c.split(",")[1],f.name=e.prefix[f.id].name,f.stat=e.prefix[f.id].stats,e.item2Prefix=f;var g={};g.id=c.split(",")[2]||"0",g.name=e.suffix[g.id].name,e.suffix[g.id].hasOwnProperty("stats")?g.modif=e.suffix[g.id].stats.acc:g.modif=0,e.item2Suffix=g;var h={};h.id=c.split(",")[3],h.name=e.grade[h.id].name,h.min=e.grade[h.id].min,h.max=e.grade[h.id].max,e.item2Grade=h,e.finalStats1=r(e.item1Stat,u,m,d),e.finalStats2=r(e.item2Stat,f,g,h),e.existingStats=[];for(var v=0;v<a.length;v++){var y=a[v];(e.finalStats1[y]||e.finalStats2[y])&&(e.existingStats.push(y),e.finalStats1[y]=e.finalStats1[y]||{min:0,max:0},e.finalStats2[y]=e.finalStats2[y]||{min:0,max:0})}e.item1Stat.finalRarity=n.getItemQuality(e.item1Stat,u.id>0,m.id>0),e.item2Stat.finalRarity=n.getItemQuality(e.item2Stat,f.id>0,g.id>0);var S;S=e.itsWeapon?"weapon":e.itsArmor?"armor":"trinket",e.pageName=S,e.suffixPrefixChange=function(e,n,r,a,i,o){var s="#!/tools/compare?c=";s+=t.c.split("-")[0].split(",")[0]+",",s+=e+",",s+=n+",",s+=r,s+="-",s+=t.c.split("-")[1].split(",")[0]+",",s+=a+",",s+=i+",",s+=o,$(location).attr("href",s)},e.getMinMaxClass=function(e,t){return e.min<t.min?"compareLose":e.min==t.min?"compareTie":"compareWin"},e.getSign=function(e,t){return e.min<t.min?"<":e.min==t.min?"=":">"};var x="[Comparsion: "+e.item1Stat.name+" and "+e.item2Stat.name+"] ("+window.location.href+")";$("#raw-url-link").click(function(){$("#generatedLink").show(),$("#generatedLink-reddit").addClass("hide")}),$("#reddit-url-link").click(function(){$("#generatedLink").hide(),$("#generatedLink-reddit").removeClass("hide")}),$("#generatedLink").val(window.location.href),$("#generatedLink-reddit").val(x)}]),angular.module("mainApp").controller("toolCtrl",["$scope","$routeParams",function(e,t){}]),angular.module("mainApp").filter("spaceless",function(){return function(e){if(e)return e.replace(/\s+/g,"_")}}).filter("timestampToDate",function(){return function(e){function t(e){return e>9?""+e:"0"+e}var n=new Date(1e3*e),r=n.getFullYear(),a=t(n.getMonth()+1),i=t(n.getDate()),o=t(n.getHours()),s=t(n.getMinutes()),l=r+"."+a+"."+i+" "+o+":"+s;return l}}).filter("duration",function(){function e(e){var t,n=Math.floor(e/60);if(e<600){t=n+"m ";var r=Math.floor(e%60);r>0&&(t+=" "+r+"s")}else e<36e3?(t="~"+Math.floor(n/60)+"h",n%=60,n>0&&(t+=" "+n+"m")):t="~"+Math.round(n/60)+"h";return t}return function(t,n,r){var a;return a=r==n?e(t*n):e(t*n)+" - "+e(t*r)}}).filter("durationToDays",function(){return function(e){var t,n=Math.round(e/60/60/24);return t=n%10==1?" day":" days",n+t}}).filter("curTimestamp",function(){return function(e){var t=Math.floor(Date.now()/1e3);return t>e?0:1}}).filter("changeStat",["filtersService",function(e){var t=e.statsNames;return function(e){return void 0!=t[e]?t[e]:e}}]).filter("grade",["$filter","itemsService",function(e,t){var n=e("number");return function(e,r){var a=t.getStatAfterGrade(e,r);return n(a,0)}}]).filter("fixPercentStat",function(){var e=["atkPct","matkPct","defPct","mdefPct","accPct","hpPct","critMod"];return function(t,n){return e.indexOf(n)===-1?t:100*t}}).filter("imageToCssClass",function(){var e={"Armor/":"ico-item","Materials/":"ico-item","Weapons/":"ico-item","Consumables/":"ico-item","Quests/":"ico-quest","Skills/":"ico-skill"},t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return function(n,r){if(void 0==r){for(var a,i=0;i<t.length&&(a=t[i],0!==n.indexOf(a));i++)a=null;null==a&&(a="Quests/",n=a+n),r=e[a],n=n.replace(a,r+"-")}else n=r+"-"+n;var o=r+" "+n.replace("/","-").replace(" ","-").replace(".png","");return o}}),function(){function e(){var e=this;e.isAllSelected=!1,e.idPrefix="f-"+Math.floor(1e7*(1+Math.random()))+"-",e.selectAll=function(){e.isAllSelected=!e.isAllSelected;for(var t=0;t<e.total;t++){var n=e.optionsArr[t];e.options[n].selected=e.isAllSelected}e.currentlyChecked=e.isAllSelected?e.total:0,e.triggerFilterChanged()},e.optionsArr=[];for(var t in e.options)e.options.hasOwnProperty(t)&&e.optionsArr.push(t);e.total=e.optionsArr.length,e.currentlyChecked=0,e.getId=function(t){return e.idPrefix+t.replace(/[^\w]/g,"_")},e.needBreak=function(t,n){return e.breakCount&&t!=n&&(t+1)%e.breakCount==0},e.filterChanged=function(t){e.options[t].selected?e.currentlyChecked++:e.currentlyChecked--,e.isAllSelected=e.currentlyChecked==e.total,e.triggerFilterChanged()},e.triggerFilterChanged=function(){e.onFilterChanged&&e.onFilterChanged({$isAllSelected:e.isAllSelected,$countSelected:e.currentlyChecked})}}var t={templateUrl:"/templates/common-filter-component.html",bindings:{options:"<",title:"@",cssClass:"@",breakCount:"<",onFilterChanged:"&"},controller:e,controllerAs:"Filter"};angular.module("mainApp").component("commonFilter",t)}(),function(){function e(){var e=this;e.$onInit=function(){e.itemUrl=window.location.href,e.redditText="["+e.redditName+"] ("+e.itemUrl+")",e.labelText=e.title||"Unique Item URL:"}}var t={templateUrl:"templates/filter-count-component.html",bindings:{numberOfItems:"<",numberAfterFilter:"<"},controller:e,controllerAs:"ctrl"};angular.module("mainApp").component("filterCount",t)}(),function(){function e(e){var t=this;t.copyModel=e.copyModel,t.$onInit=function(){t.itemUrl=window.location.href,t.redditText="["+t.redditName+"] ("+t.itemUrl+")",t.labelText=t.title||"Unique Item URL:"},t.toogleReddit=function(e){t.copyModel.showReddit=e}}e.$inject=["popupService"];var t={templateUrl:"/templates/item-url-component.html",bindings:{redditName:"<",title:"@"},controller:e,controllerAs:"url"};angular.module("mainApp").component("itemUrl",t)}(),angular.module("mainApp").service("filtersService",function(){var e=this;e.isMatch=function(e,t){var n=t[e];return n&&n.selected},e.filterStats=function(t,n){for(var r=0;r<e.statsCount;r++){var a=e.statsArr[r];if(t[a]){var i=n[a];if(i&&i.selected)return!0}}return!1},e.getTiers=function(){return{1:{title:"1"},2:{title:"2"},3:{title:"3"},4:{title:"4"},5:{title:"5"},6:{title:"6"}}},e.getBlacksmithTypes=function(){return{Dagger:{title:"Dagger"},Sword:{title:"Sword"},Hatchet:{title:"Hatchet"},Knife:{title:"Knife"},Longsword:{title:"Longsword"},Axe:{title:"Axe"}}},e.getWoodworkerTypes=function(){return{Wand:{title:"Wand"},"Mystic Wand":{title:"Mystic Wand"},Stave:{title:"Stave"},"Mystic Stave":{title:"Mystic Stave"},Cudgel:{title:"Cudgel"},Club:{title:"Club"}}},e.getSpecialTypes=function(){return{Rod:{title:"Rod"},Pole:{title:"Pole"},Trident:{title:"Trident"},Spellsword:{title:"Spellsword"},Scythe:{title:"Scythe"}}},e.getArmorsmithTypes=function(){return{Bracers:{title:"Bracers"},Greaves:{title:"Greaves"},Helm:{title:"Helm"},Chainmail:{title:"Chainmail"},Gauntlets:{title:"Gauntlets"},Sabatons:{title:"Sabatons"},"Great Helm":{title:"Great Helm"},Platemail:{title:"Platemail"}}},e.getClothWorkerTypes=function(){return{Gloves:{title:"Gloves"},Boots:{title:"Boots"},Hood:{title:"Hood"},Tunic:{title:"Tunic"},Mitts:{title:"Mitts"},Crakows:{title:"Crakows"},Hat:{title:"Hat"},Robe:{title:"Robe"}}},e.getTrinketsTypes=function(){return{Amulet:{title:"Amulet"},Earring:{title:"Earring"},Medallion:{title:"Medallion"},Necklace:{title:"Necklace"},Pendant:{title:"Pendant"},Ring:{title:"Ring"},Trinket:{title:"Trinket"},None:{title:"None"}}},e.getPotionsTypes=function(){return{Health:{title:"Health"},Boost:{title:"Boost"},Enchant:{title:"Enchant"},Scroll:{title:"Scroll"}}},e.getMaterialTypes=function(){return{ore:{title:"Ore"},metal:{title:"Metal"},log:{title:"Log"},cloth:{title:"Cloth"},herb:{title:"Herb"},limb:{title:"Limb"},scale:{title:"Scale"},tooth:{title:"Tooth"},fur:{title:"Fur"},plate:{title:"Plate"},blade:{title:"Blade"},hilt:{title:"Hilt"},crystal:{title:"Crystal"},gem:{title:"Gem"},rune:{title:"Rune"},shell:{title:"Shell"},claw:{title:"Claw"},horn:{title:"Horn"},misc:{title:"Misc"},fang:{title:"Fang"},wing:{title:"Wing"}}},e.statsNames={atkBns:"Atk",atkPct:"Atk%",matkBns:"mAtk",matkPct:"mAtk%",defBns:"Def",defPct:"Def%",mdefBns:"mDef",mdefPct:"mDef%",accBns:"Acc",accPct:"Acc%",critBns:"Crit",critMod:"CDmg%",hpBns:"HP",hpPct:"HP%",lckMod:"Luck",expMod:"Exp",str:"Str",dex:"Dex","int":"Int",speed:"Speed",apMod:"AP",gldMod:"Gold"},e.hiddenStats=["gldMod"],e.statsArr=[];for(var t in e.statsNames)e.statsNames.hasOwnProperty(t)&&e.statsArr.push(t);e.statsCount=e.statsArr.length,e.getStatsFilter=function(){for(var t={},n=0;n<e.statsCount;n++){var r=e.statsArr[n];e.hiddenStats.indexOf(r)<0&&(t[r]={title:e.statsNames[r]})}return t}}),angular.module("mainApp").service("guidesService",["$http","$q",function(e,t){var n=this;n.getGuides=function(){var r=t.defer();return void 0!=n.guidesList?(r.resolve(n.guidesList),r.promise):(e.get("http://merchantgamedb.com/guides/wp-json/wp/v2/posts?filter[cat]=6").then(function(e){n.guidesList=e.data,r.resolve(n.guidesList)}),r.promise)},n.getGuideByTitle=function(e){var t="";return void 0==n.guidesList?(console.warn("using getGuideByTitle before guides are loaded"),t):($.each(n.guidesList,function(r,a){if(n.guidesList[r].title.rendered==e)return t=a,!1}),t)},n.getAuthorByID=function(e){var t="";return 1==e?t="Chirp":2==e?t="Phaturia":3==e?t="EnzymSama":4==e?t="Kamighty":5==e&&(t="Rkinasz"),t}}]),angular.module("mainApp").service("itemsService",function(){var e=this;e.getItemQuality=function(e,t,n){var r=e.rarity<7?6:8,a=e.rarity;return t&&a++,n&&a++,Math.min(a,r)},e.initGradeFromRoute=function(e,t){e.listOfGrades=jsonGrades,t.grade?e.grade=t.grade:e.grade="0",e.minGradeModifier=jsonGrades[e.grade].min,e.maxGradeModifier=jsonGrades[e.grade].max,e.craftTimeMin=jsonGrades[e.grade].craftTimeMin,e.craftTimeMax=jsonGrades[e.grade].craftTimeMax,e.gradeName=jsonGrades[e.grade].name},e.initSuffixFromRoute=function(e,t){e.listOfSuffix=jsonSuffixes,e.suffix="0",t.suffix&&(e.suffix=t.suffix),e.hasSuffix=e.suffix>0,e.suffixMod=1+getSuffixMod(e.suffix)},e.initPrefixFromRoute=function(t,n){t.listOfPrefix=jsonPrefixes,t.prefix="0",n.prefix&&(t.prefix=n.prefix,t.prefixStat=e.getPrefixById(t.prefix)),t.hasPrefix=t.prefix>0},e.initPrestigeLevelFromRoute=function(e,t){e.listOfItemPrestige=[{name:"None"},{name:"1"},{name:"2"}],e.prestigeLevel="0",t.prestigeLevel&&(e.prestigeLevel=t.prestigeLevel);var n=+e.prestigeLevel;e.prestigeLevelNumber=isNaN(n)?0:n},e.initFromRoute=function(t,n){e.initGradeFromRoute(t,n),6!=t.item.crafterID&&e.initSuffixFromRoute(t,n),e.initPrefixFromRoute(t,n),e.initPrestigeLevelFromRoute(t,n),e.initQuality(t),t.itemValue=e.getItemValue(t.item,t.prestigeLevelNumber)},e.getItemValue=function(e,t){var n=e.value;return t&&t>0&&(n=2*n*t),n},e.getPrefixById=function(e){return jsonPrefixes[e]},e.initQuality=function(t){t.finalRarity=e.getItemQuality(t.item,t.hasPrefix,t.hasSuffix)},e.getStatAfterGrade=function(e,t){var n;return n=e<=-1?e/t:e<1&&e>-1?100*e-1e-7:e*t,Math.ceil(n)};var t=[40,80];e.getLevelForAscendedItem=function(e,n){return n&&n>0?e.itemLevel+t[n-1]:e.itemLevel},e.getBaseStat=function(t,n){var r=e.getLevelForAscendedItem(t.item,t.prestigeLevelNumber),a=t.itemBaseStat[n+"Base"],i=t.itemBaseStat[n+"Lvl"];return a+i*r};var n={none:[1,1],min:[1.1,1.2],low:[1.25,1.5],mid:[1.5,2],high:[1.75,2.5],"super":[2,3]},r={str:n.high,"int":n.high,dex:n.high,lckMod:n.low,expMod:n.low,atkBns:n.high,matkBns:n.high,accBns:n.mid,critBns:n.min,defBns:n.mid,mdefBns:n.mid,hpBns:n.high,apMod:n.none,speed:n.none,atkPct:n.low,matkPct:n.low,defPct:n.low,mdefPct:n.low,accPct:n.low,hpPct:n.low,critMod:n.low};e.getAscendingMulti=function(e,t){return r[e][t-1]},e.prepareBonusStats=function(t){var n={},r=t.item.bonusStat;for(var a in r)if(r.hasOwnProperty(a)){var i=r[a],o=e.getStatAfterGrade(i[0],t.minGradeModifier),s=e.getStatAfterGrade(i[1],t.maxGradeModifier),l=t.prestigeLevelNumber;if(l>0){var u=e.getAscendingMulti(a,l);o=Math.round(o*u),s=Math.round(s*u)}n[a]=[o,s]}return n},e.constructUrl=function(e,t){var n=t,r=!1;e.suffix&&e.suffix>0&&(n+="?suffix="+e.suffix,r=!0),e.prefix&&e.prefix>0&&(n+=(r?"&":"?")+"prefix="+e.prefix,r=!0),e.grade&&e.grade>0&&(n+=(r?"&":"?")+"grade="+e.grade,r=!0),e.prestigeLevel&&e.prestigeLevel>0&&(n+=(r?"&":"?")+"prestigeLevel="+e.prestigeLevel,r=!0),$(location).attr("href",n)}}),angular.module("mainApp").service("popupService",["itemsService",function(e){function t(t,n,r,a,i){var o={fullName:t.name,id:getEquipmentIdByName(t.name),image:t.image,prefix:r||"",suffix:n||"",grade:a||"",type:i};if(o.suffix&&o.suffix>0&&(o.fullName+=" +"+o.suffix),o.prefix){var s=e.getPrefixById(r);s&&(o.fullName=s.name+" "+o.fullName)}return o}var n=this;n.modes={none:0,showLink:1,showComparisonPrompt:2},n.popupModel={mode:n.modes.none},n.copyModel={showReddit:!1},n.comparisonModel={},n.hide=function(){n.popupModel.mode=n.modes.none},n.toogleCopyLink=function(){n.popupModel.mode==n.modes.none?n.popupModel.mode=n.modes.showLink:n.popupModel.mode=n.modes.none},n.toogleComparisonPrompt=function(){n.popupModel.mode==n.modes.none?n.popupModel.mode=n.modes.showComparisonPrompt:n.popupModel.mode=n.modes.none},n.checkComparisonValid=function(){var e=n.comparisonModel;e.item1&&e.item2&&e.item1.type!=e.item2.type?e.hasError=!0:e.hasError=!1},n.comparisonModel.isReady=function(){var e=n.comparisonModel;return null!=e.item1&&null!=e.item2&&!e.hasError},n.addItemToComparison=function(e,r,a,i){var o=1==e.itemSlot?"Weapon":"Armor",s=t(e,r,a,i,o);null==n.comparisonModel.item1?n.comparisonModel.item1=s:n.comparisonModel.item2=s,n.comparisonModel.currentOperation=s.fullName+" added to comparsion table.",n.checkComparisonValid(),n.toogleComparisonPrompt()},n.removeItemFromComparison=function(e){var t;1==e?(t=n.comparisonModel.item1.fullName,n.comparisonModel.item1=n.comparisonModel.item2):t=n.comparisonModel.item2.fullName,n.comparisonModel.item2=null,n.comparisonModel.currentOperation=t+" removed from comparsion table.",n.checkComparisonValid()},n.clearComparison=function(){n.comparisonModel.item1=null,n.comparisonModel.item2=null,n.checkComparisonValid()}}]),angular.module("mainApp").service("questService",function(){var e=this;e.grade="0",e.luck=0,e.setValues=function(t,n){e.grade=t,e.luck=n||0},e.setupQuestScope=function(t){t.grade=e.grade,t.luck=Math.max(e.luck,0);var n=jsonGrades[t.grade];t.minGradeModifier=n.lootModMin,t.maxGradeModifier=n.lootModMax,t.nilOddsModMin=n.nilOddsMin,t.nilOddsModMax=n.nilOddsMax,t.reward3&&(t.reward3NilMax=Math.max(t.reward3.nilOdds*n.nilOddsMax-e.luck,1),t.reward3NilMin=Math.max(t.reward3.nilOdds*n.nilOddsMin-e.luck,1)),t.reward4&&(t.reward4NilMax=Math.max(t.reward4.nilOdds*n.nilOddsMax-e.luck,1),t.reward4NilMin=Math.max(t.reward4.nilOdds*n.nilOddsMin-e.luck,1)),"0"==t.grade&&(n=jsonGrades[5]),t.gradeForCap=n.name;var r="";r+=Math.ceil(10*(4.5-t.quest.reward1[1]*n.lootModMin)),r+=" / "+Math.ceil(10*(4.5-t.quest.reward2[1]*n.lootModMin)),t.reward3&&(r+=" / "+Math.max(Math.ceil(t.reward3.nilOdds*n.nilOddsMin)-1,0)),t.reward4&&(r+=" / "+Math.max(Math.ceil(t.reward4.nilOdds*n.nilOddsMin)-1,0)),t.luckCaps=r;
},e.getMonsterByMaterialId=function(t){function n(e,t,n,r){return{name:n?e.nameB:e.name,rarity:n?e.titleB:e.title,icon:e.image,oddsMin:100,oddsMax:100,min:Math.min(t[1]*u+.1*l,5),max:Math.min(t[2]*m+.1*l,5),region:regionById(e.region),gid:r}}function r(e,t,n,r){return{name:n?e.nameB:e.name,rarity:n?e.titleB:e.title,icon:e.image,oddsMin:i[t].oddsMin,oddsMax:i[t].oddsMax,min:i[t].min,max:i[t].max,region:regionById(e.region),gid:r}}var a=[],i=[],o=[],s=jsonGrades[e.grade],l=e.luck,u=s.lootModMin,m=s.lootModMax;return $.each(jsonParcel,function(n,r){var a=0,l="",u="",m="";if($.each(r.itemList,function(e,r){if(a+=r.odds,r.id-1==t){r.amount[5]?(l=r.amount[0],u=r.amount[4]):r.amount[3]?(l=r.amount[0],u=r.amount[2]):(l=r.amount[0],u=r.amount[0]),m=r.odds;var i=o.indexOf(n);i<0&&o.push(n)}}),m){var d=m/(a+Math.max(r.nilOdds*s.nilOddsMax-e.luck,1))*100,c=m/(a+Math.max(r.nilOdds*s.nilOddsMin-e.luck,1))*100,p={name:n,min:l,max:u,oddsMin:d,oddsMax:c};i.push(p)}}),$.each(jsonQuests,function(e,i){if("Placeholder"!=i.title){if(i.rewardA1[0]-1==t){var s=n(i,i.rewardA1,!1,e);a.push(s)}else if(i.rewardA2[0]-1==t){var s=n(i,i.rewardA2,!1,e);a.push(s)}var l=o.indexOf(i.rewardA3);if(l>-1){var s=r(i,l,!1,e);a.push(s)}if(l=o.indexOf(i.rewardA4),l>-1){var s=r(i,l,!1,e);a.push(s)}if(i.hasOwnProperty("nameB")){if(i.rewardB1[0]-1==t){var s=n(i,i.rewardB1,!0,e);a.push(s)}else if(i.rewardB2[0]-1==t){var s=n(i,i.rewardB2,!0,e);a.push(s)}if(l=o.indexOf(i.rewardB3),l>-1){var s=r(i,l,!0,e);a.push(s)}if(l=o.indexOf(i.rewardB4),l>-1){var s=r(i,l,!0,e);a.push(s)}}}}),a}}),angular.module("mainApp").service("regionService",function(){var e=this,t=["image","levelReq","region","attackList"],n=["name","nickname","enemyImage","title","exp","gold","time","enemyHp","enemyAtk","enemyMatk","enemyDef","enemyMdef","enemyEva"];e.mapQuestData=function(e,r,a){for(var i={},o=0;o<t.length;o++){var s=t[o];i[s]=e[s]}for(var o=0;o<n.length;o++){var s=n[o],l=s;r&&(l+="B"),i[s]=e[l]}for(var o=1;o<=4;o++){var l="reward"+(r?"B":"A")+o;i["reward"+o]=e[l]}i.region2=regionById(e.region);var u=1;e.hasOwnProperty("questSize")&&(u=e.questSize),i.questSize=u,0==i.title.length&&(i.title="Normal"),i.type=r?"b":"a";var m="";return r?m=e.name:e.hasOwnProperty("nameB")&&(m=e.nameB),i.other=m,i.gid=a,i},e.getQuestByName=function(t,n){var r,a;return n?(r=jsonQuests[n],a=n):$.each(jsonQuests,function(e,n){return n.name==t?(r=n,a=e,!1):n.nameB==t?(r=n,a=e,!1):void 0}),e.mapQuestData(r,r.nameB==t,a)},e.getQuestsForRegion=function(t){var n=0;"Tuvale Forest"==t?n=1:"Yarsol Cove"==t?n=2:"Aldur Highlands"==t?n=3:"Vulkrum Badlands"==t?n=4:"Grimhal Volcano"==t?n=5:"Frentir Chasm"==t&&(n=6);var r=[];return $.each(jsonQuests,function(t,a){a.region==n&&"Placeholder"!=a.title&&(r.push(e.mapQuestData(a,!1,t)),a.nameB&&r.push(e.mapQuestData(a,!0,t)))}),r}}),angular.module("mainApp").service("searchService",function(){var e=this,t={shouldSort:!0,threshold:.3,location:0,distance:100,maxPatternLength:32,minMatchCharLength:2,keys:[{name:"name",weight:.7},{name:"type",weight:.3}]},n=jsonSearch;e.fuse=new Fuse(n,t),e.fuseSearch=function(t){return e.fuse.search(t)}}),$(document).on("click","#commentsButton",function(){$("#comments").show(),resetDisqus(),$("#commentsButton").hide()}),function(){for(var e,t=function(){},n=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeline","timelineEnd","timeStamp","trace","warn"],r=n.length,a=window.console=window.console||{};r--;)e=n[r],a[e]||(a[e]=t)}(),window.setTimeout(function(){var e=0,t=0,n=14,r=10;$.getJSON("http://www.reddit.com/r/MerchantRPG.json?sort=top&t=week&limit=40&jsonp=?",function(a){$.each(a.data.children,function(a,i){var o="";i.data.thumbnail&&"self"!=i.data.thumbnail&&t<n?t++:e<=r&&(e++,o='<li><p><strong><a href="'+i.data.url+'" target="_blank" rel="noopener">'+i.data.title+"</strong></a></p>",o+="<p>"+i.data.ups+'&uarr; | <a href="//reddit.com'+i.data.permalink+'" target="_blank" rel="noopener">'+i.data.num_comments+" Comments</a></p></li>"),$("#reddit .posts").append(o)})})},1e3);